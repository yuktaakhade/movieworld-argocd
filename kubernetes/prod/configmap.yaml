apiVersion: v1
kind: ConfigMap
metadata:
  name: movieworld-config
  namespace: movie-prod
data:
  application.properties: |
    # Database Configuration
    spring.datasource.url=jdbc:mysql://${DB_HOST:movieworld-mysql.movie.svc.cluster.local}:${DB_PORT:3306}/${DB_NAME:movieworld}
    spring.datasource.username=${DB_USER:movieworld}
    spring.datasource.password=${DB_PASSWORD:movieworldpass}
    spring.jpa.hibernate.ddl-auto=update
    spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
    
    # Service URLs
    moviereview.service.url=${MOVIE_REVIEW_SERVICE_URL:http://moviereview:9093}
    
    # Actuator Configuration
    management.endpoints.web.exposure.include=health,info,metrics,prometheus,loggers
    management.endpoint.health.show-details=always
    management.endpoint.loggers.enabled=true
    management.endpoint.metrics.enabled=true
    management.endpoint.prometheus.enabled=true
    management.metrics.distribution.percentiles-histogram.http.server.requests=true
    
    # OpenTelemetry Configuration
    otel.sdk.disabled=${OTEL_SDK_DISABLED:false}
    otel.exporter.otlp.endpoint=${OTEL_EXPORTER_OTLP_ENDPOINT:http://otel-collector:4317}
    otel.metrics.exporter=otlp
    otel.logs.exporter=otlp
    otel.propagators=tracecontext,baggage,b3
    
    # Logging Configuration
    logging.pattern.level=%5p [${spring.application.name:},%X{traceId:-},%X{spanId:-}]
  
  database-url: jdbc:mysql://movieworld-mysql.movie.svc.cluster.local:3306/movieworld
  moviereview-service-url: http://moviereview:9093
